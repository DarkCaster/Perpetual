# Init operation

The `init` operation is a starting point for using Perpetual with your project. It sets up the necessary configuration and directory structure required for Perpetual to function properly within your project environment.

## Usage

To initialize a new Perpetual configuration for your project, run the following command **from the root directory of your project**:

```sh
Perpetual init [flags]
```

The `init` operation supports several command-line flags to customize its behavior:

- `-l <language>`: Select the programming language for setting up default LLM prompts. This flag is required and must be provided with a valid language option.

- `-h`: Display the help message, showing all available flags and their descriptions.

- `-v`: Enable debug logging. This flag increases the verbosity of the operation's output, providing more detailed information about the initialization process.

- `-vv`: Enable both debug and trace logging. This flag provides the highest level of verbosity, useful for troubleshooting or understanding the internal workings of the initialization process.

Example usage:

```sh
Perpetual init -l go
```

This command initializes Perpetual for a Go project, setting up the appropriate configuration and prompt files.

## Supported languages

Perpetual currently supports the following programming languages and technologies:

1. Go (`go`)
2. .NET Framework (`dotnetfw`) - C#, VB.NET, WPF.
3. Bash (`bash`), **NOTE:** by default, intended mostly for Linux use.
4. Python 3 (`python3`)
5. Visual Basic 6 (`vb6`). **NOTE:** Not really works well, will be removed in future.

When using the `-l` flag, provide the language identifier as shown in parentheses above.

## Details

The `init` operation performs several tasks to set up your project for use with Perpetual:

1. Creates a `.perpetual` directory in your project root.
2. Generates default configuration files and prompts for the selected programming language.

When run inside an already initialized project root, it will overwrite current config files and create missing ones.

### Directory and File Structure

After running the `init` operation, the following structure is created:

```text
<project_root>/
└── .perpetual/
    ├── .gitignore
    ├── .env.example
    ├── filename_embed_regexp.json
    ├── filename_tags_regexps.json
    ├── filename_tags.json
    ├── no_upload_comment_regexps.json
    ├── op_implement_comment_regexps.json
    ├── output_tags_regexps.json
    ├── project_files_blacklist.json
    ├── project_files_to_markdown_lang_mappings.json
    ├── project_files_whitelist.json
    ├── reasonings_tags_regexps.json
    ├── reasonings_tags.json
    └── prompts/
        └── <default LLM prompts as plain text files>
```

### Customizable Files

Most files generated by the `init` operation can be customized to fine-tune Perpetual's behavior for your project:

1. `.env`: This file is not created by default, but you can copy the `.env.example` file and modify it to set environment variables for configuring Perpetual and its LLM providers.

   Perpetual looks for `.env` files in multiple locations, loading them in the following order:

   - Global configuration file (e.g., `~/.config/Perpetual/.env` on Linux, `<User profile dir>\AppData\Roaming\Perpetual\.env` on Windows)
   - Project-wide configuration file from `.perpetual` directory inside project root (`<project_root>/.perpetual/.env`)

   Environment variables can also be set manually before launching Perpetual. The variables defined in these files are essential for proper operation, as they configure LLM providers, API keys, and other important settings.

2. Prompt files in the `prompts/` directory: These files contain the prompts used by Perpetual for various operations. You can modify these to adjust the behavior of the AI model for your specific project needs.

3. JSON configuration files: These files contain regular expressions and configurations used by Perpetual for source-code file handling and processing. You can modify these to change how Perpetual interacts with your project files, what files it can select for operation, and what files it will filter out from use. This is useful for filtering out specific sub-projects, tests, confidential files, etc.

These configuration files can be added to version control systems (VCS) like Git, allowing you to share and track changes to your Perpetual configuration across your development team.

### Files Not Intended for User Modification

The following files and directories should not be modified directly by users:

1. `.annotations.json`: This file stores the source code annotations generated by Perpetual for your project files for use with other operations to make LLM aware about your project structure. Updated automatically during normal use. Use `annotate` operation if you really need to modify it.
2. `.stash/`: This directory is used by Perpetual to store source-code backups during operations, use `stash` operation to work with such backups.
3. `.message_log.txt`: This file contains logs of interactions between Perpetual and the LLM provider. It's used for debugging and tracking the AI's responses.
